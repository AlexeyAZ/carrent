{"version":3,"sources":["app.js"],"names":["$","body","thanksLocation","wlLand","name","addClass","el","cls","domEl","document","querySelector","classList","add","appLoad","setTimeout","documentElement","remove","viewportChecker","classToAdd","offset","callbackFunction","countTo","speed","window","addEventListener","length","rangeslider","polyfill","webshim","setOptions","lazyCustomMessages","replaceValidationUI","phoneLink","md","MobileDetect","navigator","userAgent","mobile","attr","data","removeClass","inputmask","greedy","clearIncomplete","on","e","preventDefault","self","target","hasClass","wl","callbacks","onFormSubmit","$form","res","status","smallFormHandler","def","bigFormHandler","submit","formAction","smallFormWrap","bigFormWrap","openSmallForm","openBigForm","callback","closeSmallForm","closeBigForm","setInputValues","userInfo","localStorage","getItem","JSON","parse","val","phone","email","city","setInputTitle","titleVal","innerText","forms","querySelectorAll","inputTitles","i","form","formInput","createInputEl","insertBefore","firstElementChild","j","input","value","createElement","type","selfName","find","selfPhone","selfEmail","selfCity","formData","serialize","landUserInfo","setItem","stringify","ajax","url","success","location","thanksPageHandler","isThanksPage","text"],"mappings":"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","file":"app.js","sourcesContent":["/*global webshim $ wl MobileDetect*/\r\n\r\n$(function() {\r\n\r\n    var body = $(\"body\");\r\n    var thanksLocation = \"thanks.html\";\r\n    var wlLand = false;\r\n    var name;\r\n\r\n    function addClass(el, cls) {\r\n        var domEl = document.querySelector(el);\r\n\r\n        if (domEl) {\r\n            domEl.classList.add(cls);\r\n        }\r\n    }\r\n\r\n    function appLoad() {\r\n\r\n        setTimeout(function() {\r\n            document.documentElement.classList.remove(\"loading\");\r\n        }, 100);\r\n\r\n        setTimeout(function() {\r\n            addClass(\".header__logo\", \"header__logo_show\");\r\n            addClass(\".sec1__car\", \"sec1__car_move\");\r\n        }, 200);\r\n\r\n        $('.sec3__decor-img').viewportChecker({\r\n            classToAdd: 'sec3__decor-img_move',\r\n            offset: 100,\r\n        });\r\n\r\n        $('.sec6__car').viewportChecker({\r\n            classToAdd: 'sec6__car_move',\r\n            offset: 100,\r\n        });\r\n\r\n        $('.sec6__img').viewportChecker({\r\n            //classToAdd: 'sec6__car_move',\r\n            offset: 100,\r\n            callbackFunction: function() {\r\n                $('.sec6__timer').countTo({\r\n                    speed: 2000,\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    window.addEventListener(\"load\", appLoad);\r\n\r\n\r\n    if ($('input[type=\"range\"]').length) {\r\n        $('input[type=\"range\"]').rangeslider({\r\n            polyfill: false,\r\n        });\r\n    }\r\n\r\n    webshim.setOptions('forms', {\r\n        lazyCustomMessages: true,\r\n        replaceValidationUI: true\r\n    });\r\n    webshim.polyfill('forms');\r\n\r\n    function phoneLink() {\r\n        var md = new MobileDetect(window.navigator.userAgent);\r\n        var phoneLink = $(\"[data-phone]\");\r\n\r\n        if (md.mobile()) {\r\n            phoneLink.attr(\"href\", \"tel:\" + $(\".phone-link\").data(\"phone\"));\r\n            phoneLink.removeClass(\"js-small-btn\");\r\n        } else {\r\n            phoneLink.attr(\"href\", \"\");\r\n            phoneLink.addClass(\"js-small-btn\");\r\n        }\r\n    }\r\n    phoneLink();\r\n\r\n    // form handler\r\n\r\n    $(\"input[name=phone]\").inputmask({\r\n        \"mask\": \"+9(999)999-9999\",\r\n        greedy: false,\r\n        clearIncomplete: true\r\n    });\r\n\r\n    body.on(\"click\", \".js-small-btn\", function(e) {\r\n        e.preventDefault();\r\n\r\n        if (!$(\".thanks\").length) {\r\n            $(\"html\").addClass(\"form-open\");\r\n            $(\".form-wrap_small\").addClass(\"form-wrap_open\");\r\n        }\r\n    });\r\n\r\n    body.on(\"click\", function(e) {\r\n        var self = $(e.target);\r\n        \r\n        if (self.hasClass(\"form-wrap\") || self.hasClass(\"form__close\")){\r\n            $(\"html\").removeClass(\"form-open\");\r\n            $(\".form-wrap\").removeClass(\"form-wrap_open\");\r\n        } \r\n    });\r\n\r\n    if (typeof wl != \"undefined\") {\r\n        wlLand = true;\r\n\r\n        wl.callbacks.onFormSubmit = function ($form, res) {\r\n            if ($form.data('next')) {\r\n            \r\n                if(res.status == 200) {\r\n                    smallFormHandler($form);\r\n                } else {  \r\n                    wl.callbacks.def.onFormSubmit($form, res);\r\n                }\r\n            } else {\r\n                bigFormHandler($form);\r\n            }\r\n        };\r\n    } else {\r\n        wlLand = false;\r\n\r\n        $(\"#smallForm, #bottomForm\").submit(function(e) {\r\n            e.preventDefault();\r\n            var self = $(this);\r\n\r\n            smallFormHandler(self);\r\n        });\r\n\r\n        $(\"#bigForm\").submit(function(e) {\r\n            e.preventDefault();\r\n            var self = $(this);\r\n\r\n            bigFormHandler(self);\r\n        });\r\n    }\r\n\r\n    function formAction() {\r\n        var smallFormWrap = document.querySelector(\".form-wrap_small\");\r\n        var bigFormWrap = document.querySelector(\".form-wrap_big\");\r\n\r\n        return {\r\n\r\n            openSmallForm: function() {\r\n                document.documentElement.classList.add(\"form-open\");\r\n                smallFormWrap.classList.add(\"form-wrap_open\");\r\n            },\r\n\r\n            openBigForm: function(callback) {\r\n                document.documentElement.classList.add(\"form-open\");\r\n                bigFormWrap.classList.add(\"form-wrap_open\");\r\n\r\n                callback();\r\n            },\r\n\r\n            closeSmallForm: function() {\r\n                document.documentElement.classList.remove(\"form-open\");\r\n                smallFormWrap.classList.remove(\"form-wrap_open\");\r\n            },\r\n\r\n            closeBigForm: function() {\r\n                document.documentElement.classList.remove(\"form-open\");\r\n                bigFormWrap.classList.remove(\"form-wrap_open\");\r\n            },\r\n\r\n            setInputValues: function() {\r\n                var userInfo;\r\n\r\n                if (localStorage.getItem(\"landUserInfo\")) {\r\n                    userInfo = JSON.parse(localStorage.getItem(\"landUserInfo\"));\r\n                }\r\n                \r\n                $(\"[name=name1]\").val(userInfo.name);\r\n                $(\"[name=phone1]\").val(userInfo.phone);\r\n                $(\"[name=email1]\").val(userInfo.email);\r\n\r\n                if (userInfo.city !== \"\") {\r\n                    $(\"[name=city]\").val(userInfo.city);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function setInputTitle() {\r\n        var titleVal = document.querySelector(\"title\").innerText;\r\n        var forms = document.querySelectorAll(\"form\");\r\n        var inputTitles;\r\n        \r\n        for (var i = 0; i < forms.length; i++) {\r\n            var form = forms[i];\r\n            var formInput = createInputEl();\r\n            form.insertBefore(formInput, form.firstElementChild);\r\n        }\r\n\r\n        inputTitles = document.querySelectorAll(\".js-hidden-title\");\r\n\r\n        for (var j = 0; j < inputTitles.length; j++) {\r\n            var input = inputTitles[j];\r\n            input.value = titleVal;\r\n        }\r\n\r\n        function createInputEl() {\r\n            var input = document.createElement(\"input\");\r\n            input.classList.add(\"js-hidden-title\");\r\n            input.name = \"title\";\r\n            input.type = \"hidden\";\r\n            \r\n            return input;\r\n        }\r\n    }\r\n    setInputTitle();\r\n\r\n    function smallFormHandler(form) {\r\n\r\n        var selfName = form.find(\"input[name=name]\");\r\n        var selfPhone = form.find(\"input[name=phone]\");\r\n        var selfEmail = form.find(\"input[name=email]\");\r\n        var selfCity = form.find(\"input[name=city]\");\r\n        var formData = form.serialize();\r\n\r\n        var landUserInfo = {\r\n            \"name\": selfName.val(),\r\n            \"phone\": selfPhone.val(),\r\n            \"email\": selfEmail.val(),\r\n            \"city\": selfCity.val()\r\n        }\r\n\r\n        localStorage.setItem(\"landUserInfo\", JSON.stringify(landUserInfo));\r\n\r\n        name = selfName.val();\r\n\r\n        $.ajax({\r\n            type: \"POST\",\r\n            url: \"php/send.php\",\r\n            data: formData,\r\n            success: function() {\r\n                window.location = thanksLocation;\r\n            }\r\n        });\r\n\r\n        if (name) {\r\n            localStorage.setItem(\"landclientname\", name + \", наши\");\r\n        } else {\r\n            localStorage.setItem(\"landclientname\", \"Наши\");\r\n        }\r\n    }\r\n\r\n    function bigFormHandler(form) {\r\n        var formData;\r\n        formData = form.serialize();\r\n\r\n        $.ajax({\r\n            type: \"POST\",\r\n            url: \"php/sendpresent.php\",\r\n            data: formData,\r\n            success: function() {\r\n                formAction().closeBigForm();\r\n            }\r\n        });\r\n    }\r\n\r\n    function thanksPageHandler() {\r\n\r\n        if (isThanksPage()) {\r\n            formAction().openBigForm(formAction().setInputValues);\r\n            $(\"#thanksName\").text(localStorage.getItem(\"landclientname\"));\r\n            document.querySelector(\"footer\").classList.add(\"footer_bg_blue\");\r\n        }\r\n\r\n        function isThanksPage() {\r\n\r\n            if ( document.querySelector(\".thanks\") ) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    thanksPageHandler();\r\n});"]}